<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ranking de Billar</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js"></script>
    <style>
      /* Estilos Básicos */
      body {
        font-family: Arial, sans-serif;
        background-color: #f4f4f4;
        margin: 0;
        padding: 20px;
      }

      h1 {
        text-align: center;
        color: #333;
      }

      .tabla-ranking {
        width: 80%;
        margin: 20px auto;
        border-collapse: collapse;
      }

      .tabla-ranking th,
      .tabla-ranking td {
        padding: 12px;
        text-align: center;
        border: 1px solid #ddd;
      }

      .tabla-ranking th {
        background-color: #3498db;
        color: white;
      }

      .tabla-ranking tr:nth-child(even) {
        background-color: #f2f2f2;
      }

      .tabla-ranking tr:hover {
        background-color: #ddd;
      }

      .formulario {
        text-align: center;
        margin-top: 20px;
      }

      .formulario input[type="text"],
      .formulario input[type="number"] {
        padding: 10px;
        margin: 10px;
        width: 200px;
        border-radius: 4px;
        border: 1px solid #ccc;
      }

      .formulario button {
        padding: 10px 20px;
        background-color: #3498db;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
      }

      .formulario button:hover {
        background-color: #2980b9;
      }

      .alert {
        margin-top: 20px;
        text-align: center;
        color: red;
      }

      .alert-success {
        color: green;
      }
    </style>
  </head>
  <body>
    <h1>Ranking de Billar</h1>

    <!-- Tabla para mostrar el ranking -->
    <table class="tabla-ranking" id="tabla-ranking">
      <thead>
        <tr>
          <th>Jugador</th>
          <th>Puntos</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <!-- Formulario para agregar una nueva partida -->
    <div class="formulario">
      <h2>Agregar Nueva Partida</h2>
      <input type="text" id="jugador" placeholder="Nombre del Jugador" />
      <input type="number" id="puntos" placeholder="Puntos" />
      <button type="button" onclick="agregarPartida()">Agregar Partida</button>
    </div>

    <div id="alert" class="alert"></div>

    <script>
      // Configuración de Firebase
      const firebaseConfig = {
        apiKey: "AIzaSyAbLudck7S12CLKDVDWhiNRLLO1DvWwwLY",
        authDomain: "rankingbillar.firebaseapp.com",
        projectId: "rankingbillar",
        storageBucket: "rankingbillar.firebasestorage.app",
        messagingSenderId: "527851969370",
        appId: "1:527851969370:web:616b5a38062f7105a93163",
        measurementId: "G-DH55Y3ZL0E",
      };

      // Inicializa Firebase
      const app = firebase.initializeApp(firebaseConfig);
      const db = firebase.firestore();

      // Función para cargar el ranking de partidas
      async function cargarRanking() {
        const rankingRef = db.collection("ranking"); // Nombre de la colección en Firestore
        try {
          const querySnapshot = await rankingRef.get();
          const tabla = document.querySelector("#tabla-ranking tbody");
          tabla.innerHTML = ""; // Limpia la tabla antes de cargar nuevos datos

          querySnapshot.forEach((doc) => {
            const data = doc.data();
            const fila = document.createElement("tr");
            fila.innerHTML = `
                        <td>${data.jugador}</td>
                        <td>${data.puntos}</td>
                    `;
            tabla.appendChild(fila);
          });
        } catch (error) {
          console.error("Error al cargar el ranking:", error);
          document.getElementById("alert").textContent =
            "Error al cargar el ranking.";
        }
      }

      // Función para agregar una nueva partida
      async function agregarPartida() {
        const jugador = document.getElementById("jugador").value;
        const puntos = parseInt(document.getElementById("puntos").value);

        if (!jugador || isNaN(puntos)) {
          document.getElementById("alert").textContent =
            "Por favor, ingresa los datos correctamente.";
          return;
        }

        try {
          await db.collection("ranking").add({
            jugador: jugador,
            puntos: puntos,
          });
          document.getElementById("alert").textContent =
            "¡Partida agregada exitosamente!";
          document.getElementById("alert").classList.remove("alert");
          document.getElementById("alert").classList.add("alert-success"); // Cambia el estilo a éxito
          cargarRanking(); // Recarga el ranking después de agregar la partida
        } catch (error) {
          console.error("Error al agregar la partida:", error);
          document.getElementById("alert").textContent =
            "Error al agregar la partida. Inténtalo nuevamente.";
        }
      }

      // Carga el ranking inicial cuando la página se cargue
      window.onload = cargarRanking;
    </script>
  </body>
</html>
