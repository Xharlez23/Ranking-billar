<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ranking de Billar</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f9f9f9;
            color: #333;
        }
        h1, h2 {
            text-align: center;
            color: #2c3e50;
        }
        table {
            width: 60%;
            margin: 20px auto;
            border-collapse: collapse;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        table th, table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        table th {
            background-color: #3498db;
            color: white;
        }
        table tr:hover {
            background-color: #f1f1f1;
        }
        form {
            text-align: center;
            margin-top: 20px;
        }
        input[type="text"], input[type="number"] {
            padding: 8px;
            margin: 10px 0;
            width: 200px;
            border-radius: 4px;
            border: 1px solid #ccc;
        }
        button {
            padding: 10px 20px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background-color: #2980b9;
        }
        .alert {
            margin-top: 20px;
            text-align: center;
            color: #e74c3c;
        }
    </style>
  </head>
  <body>
    <h1>Ranking de Partidas de Billar</h1>

    <!-- Tabla para mostrar el ranking -->
    <table id="tabla-ranking">
      <thead>
        <tr>
          <th>Jugador</th>
          <th>Puntos</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <!-- Formulario para agregar una nueva partida -->
    <h2>Agregar Nueva Partida</h2>
    <label for="jugador">Nombre del Jugador:</label>
    <input type="text" id="jugador" placeholder="Nombre del Jugador" />
    <label for="puntos">Puntos:</label>
    <input type="number" id="puntos" placeholder="Puntos" />
    <button onclick="agregarPartida()">Agregar Partida</button>

    <script>
      // Configuración de Firebase
      const firebaseConfig = {
        apiKey: "AIzaSyAbLudck7S12CLKDVDWhiNRLLO1DvWwwLY",
        authDomain: "rankingbillar.firebaseapp.com",
        projectId: "rankingbillar",
        storageBucket: "rankingbillar.firebasestorage.app",
        messagingSenderId: "527851969370",
        appId: "1:527851969370:web:616b5a38062f7105a93163",
        measurementId: "G-DH55Y3ZL0E",
      };

      // Inicializa Firebase
      const app = firebase.initializeApp(firebaseConfig);
      const db = firebase.firestore();

      // Función para cargar el ranking de partidas
      async function cargarRanking() {
        const rankingRef = db.collection("ranking"); // Nombre de la colección en Firestore
        try {
          const querySnapshot = await rankingRef.get();
          const tabla = document.querySelector("#tabla-ranking tbody");
          tabla.innerHTML = ""; // Limpia la tabla antes de cargar nuevos datos

          querySnapshot.forEach((doc) => {
            const data = doc.data();
            const fila = document.createElement("tr");
            fila.innerHTML = `
                        <td>${data.jugador}</td>
                        <td>${data.puntos}</td>
                    `;
            tabla.appendChild(fila);
          });
        } catch (error) {
          console.error("Error al cargar el ranking:", error);
        }
      }

      // Función para agregar una nueva partida
      async function agregarPartida() {
        const jugador = document.getElementById("jugador").value;
        const puntos = parseInt(document.getElementById("puntos").value);

        if (!jugador || isNaN(puntos)) {
          alert("Por favor, ingresa los datos correctamente.");
          return;
        }

        try {
          await db.collection("ranking").add({
            jugador: jugador,
            puntos: puntos,
          });
          alert("Partida agregada exitosamente!");
          cargarRanking(); // Recarga el ranking después de agregar la partida
        } catch (error) {
          console.error("Error al agregar la partida:", error);
        }
      }

      // Carga el ranking inicial cuando la página se cargue
      window.onload = cargarRanking;
    </script>
  </body>
</html>
